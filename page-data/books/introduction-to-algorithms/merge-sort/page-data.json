{"componentChunkName":"component---src-templates-book-note-index-tsx","path":"/books/introduction-to-algorithms/merge-sort/","result":{"data":{"markdownRemark":{"html":"<p>This is an efficient algorithm for sorting a large number of elements, using the <strong>divide-and-conquer</strong> approach: break the problem into several subproblems that are similar to the original problem but smaller in size the subproblems recurseively, and then combine these solutions to create a solution to the original problem.</p>\n<p><strong>Input</strong>: A sequence of $n$ numbers $<a_1,a_2,\\cdots,a_n>$</p>\n<p><strong>Ouput</strong>: A permutation reordering $<a'_1,a'_2,\\cdots,a'n>$ of the input sequence such that $a'_1 \\leq a'_2 \\leq \\cdots \\leq a'_n$.</p>\n<p>Involves the following three steps:</p>\n<p><strong>Divide</strong>: Divide the $n$-element sequence to be sorted into two subsequence of $\\frac{n}{2}$ element each, $\\Theta(1)$.</p>\n<p><strong>Conquer</strong>: Sort the two subsequences recurseively using merge sort, $\\Theta(lg \\\\ n)$.</p>\n<p><strong>Combine</strong>: Merge the two sorted subsequences to produce the sorted answer, $\\Theta(n)$.</p>\n<p>The key operation of this algorithm is the combine step, <strong>MERGE A, p, q, r</strong>, where $A$ is an array and $p$, $q$, and $r$ are indices into the array such that $p \\leq q < r$. This procedure assumes that the subarrays $A[p..q]$ and $A[q+1..r]$ are in sorted order. It <strong>merges</strong> them to form a single sorted subarray that replaces the current subarray $A[p..r]$.</p>\n<p><strong>Description</strong>: Suppose we have two piles of cards face up on a table. Each pile is sorted, with the smallest cards on top. We wish to merge the two piles into a single sorted output pile, which is to be face down on the table. Our basic step consists of choosing the smaller of the two cards on top of the face-up piles, removing it from its pile (which exposes a new top card), and placing this card face down onto the output file. We repeat this step until one input pile is empty, at which time we just take the remaining input pile and place it face down onto the output pile.</p>\n<h5>MERGE A,p,q,r</h5>\n<p>This <em>pseudocode</em> uses <strong>sentinel</strong> card at the bottom of each pile, this sentinel value helps check for when the pile is empty. In the code it is denoted as $\\infty$, once a card with $\\infty$ is exposed it cannot be the smaller card unless both piles have their sentinel cards exposed.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\">  n_1 <span class=\"token operator\">=</span> q <span class=\"token operator\">-</span> p <span class=\"token operator\">+</span> <span class=\"token number\">1</span>\n  n_2 <span class=\"token operator\">=</span> r <span class=\"token operator\">-</span> q\n  let <span class=\"token class-name\">L</span><span class=\"token punctuation\">[</span><span class=\"token number\">1.</span><span class=\"token punctuation\">.</span>n_1 <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span> and <span class=\"token class-name\">R</span><span class=\"token punctuation\">[</span><span class=\"token number\">1.</span><span class=\"token punctuation\">.</span>n_2 <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span> be <span class=\"token keyword\">new</span> arrays\n  <span class=\"token keyword\">for</span> i <span class=\"token operator\">=</span> <span class=\"token number\">1</span> <span class=\"token keyword\">to</span> <span class=\"token namespace\">n_1</span>\n    <span class=\"token class-name\">L</span><span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token class-name\">A</span><span class=\"token punctuation\">[</span>p <span class=\"token operator\">+</span> i <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span>\n  <span class=\"token keyword\">for</span> j <span class=\"token operator\">=</span> <span class=\"token number\">1</span> <span class=\"token keyword\">to</span> <span class=\"token namespace\">n_2</span>\n    <span class=\"token class-name\">R</span><span class=\"token punctuation\">[</span>j<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token class-name\">A</span><span class=\"token punctuation\">[</span>q <span class=\"token operator\">+</span> j<span class=\"token punctuation\">]</span>\n  <span class=\"token class-name\">L</span><span class=\"token punctuation\">[</span>n_1 <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> INFTY\n  <span class=\"token class-name\">R</span><span class=\"token punctuation\">[</span>n_2 <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token class-name\">INFTY</span>\n  i <span class=\"token operator\">=</span> <span class=\"token number\">1</span>\n  j <span class=\"token operator\">=</span> <span class=\"token number\">1</span>\n  <span class=\"token keyword\">for</span> k <span class=\"token operator\">=</span> p <span class=\"token keyword\">to</span> <span class=\"token namespace\">r</span>\n    <span class=\"token keyword\">if</span> <span class=\"token class-name\">L</span><span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">&lt;=</span> <span class=\"token class-name\">R</span><span class=\"token punctuation\">[</span>j<span class=\"token punctuation\">]</span>\n      <span class=\"token class-name\">A</span><span class=\"token punctuation\">[</span>k<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token class-name\">L</span><span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span>\n      i <span class=\"token operator\">=</span> i <span class=\"token operator\">+</span> <span class=\"token number\">1</span>\n    <span class=\"token keyword\">else</span> <span class=\"token class-name\">A</span><span class=\"token punctuation\">[</span>k<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token class-name\">R</span><span class=\"token punctuation\">[</span>j<span class=\"token punctuation\">]</span>\n      j <span class=\"token operator\">=</span> j <span class=\"token operator\">+</span> <span class=\"token number\">1</span></code></pre></div>\n<p>We created two arrays $L$ (left $A[p..q]$) and $R$ (right $A[q + 1..r]$), of length $n_1 + 1$ and $n_2 + 1$ (extra position holds the sentinel) respectively.</p>\n<blockquote>\n<p>Loop invariant: At the start of each iteration of the for loop, the subarray $A[p..k - 1]$ contains the $k - p$ smallest elements of $L[1..n_1 + 1]$ and $R[1..n_2 +1]$, in sorted order. Moreover, $L[i]$ and $R[j]$ are the smallest elements of their arrays that have not been copied back into A.</p>\n</blockquote>\n<p>Now we can use the <strong>MERGE</strong> procedure as a subroutine in the merge sort algorithm. The procedure <strong>MERGE-SORT(A,p,r)</strong> sorts the elements in the subarray $A[p..r]$. If $p \\geq r$, the subarray has at most one element and is therefore already sorted. Otherwise, the divide step simply computes an index $q$ that partitions $A[p..r]$ into two subarrays: $A[p..q]$, containing $[\\frac{n}{2}]$ elements, and $A[q + 1..r]$, containing $[\\frac{n}{2}]$ elements.</p>\n<h5>MERGE-SORT A,p,r</h5>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\">  <span class=\"token keyword\">if</span> p <span class=\"token operator\">&lt;</span> r\n    q <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>p <span class=\"token operator\">+</span> r<span class=\"token punctuation\">)</span><span class=\"token operator\">/</span><span class=\"token number\">2</span>\n    MERGE<span class=\"token operator\">-</span><span class=\"token function\">SORT</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">A</span><span class=\"token punctuation\">,</span>p<span class=\"token punctuation\">,</span>q<span class=\"token punctuation\">)</span>\n    MERGE<span class=\"token operator\">-</span><span class=\"token function\">SORT</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">A</span><span class=\"token punctuation\">,</span>q <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>r<span class=\"token punctuation\">)</span>\n    <span class=\"token function\">MERGE</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">A</span><span class=\"token punctuation\">,</span>p<span class=\"token punctuation\">,</span>q<span class=\"token punctuation\">,</span>r<span class=\"token punctuation\">)</span></code></pre></div>\n<p>The worst-case running time is $\\Theta(n \\\\ lg \\\\ n)$.</p>\n<h5>Java Implementation Using Figure 2.3 In Book</h5>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\">  <span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Main</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> args<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">{</span>\n          <span class=\"token keyword\">int</span> unsortedArray<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">7</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n          <span class=\"token function\">mergeSort</span><span class=\"token punctuation\">(</span>unsortedArray<span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span>unsortedArray<span class=\"token punctuation\">.</span>length<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n          <span class=\"token function\">printArray</span><span class=\"token punctuation\">(</span>unsortedArray<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n          <span class=\"token comment\">// returns 1 2 2 3 4 5 6 7</span>\n      <span class=\"token punctuation\">}</span>\n\n      <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">mergeSort</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> array<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span> startIndex<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span> endIndex<span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">{</span>\n          <span class=\"token keyword\">int</span> midpointIndex<span class=\"token punctuation\">;</span>\n          <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>startIndex<span class=\"token operator\">&lt;</span>endIndex<span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">{</span>\n              midpointIndex <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>startIndex<span class=\"token operator\">+</span>endIndex<span class=\"token punctuation\">)</span><span class=\"token operator\">/</span><span class=\"token number\">2</span><span class=\"token punctuation\">;</span>\n              <span class=\"token function\">mergeSort</span><span class=\"token punctuation\">(</span>array<span class=\"token punctuation\">,</span>startIndex<span class=\"token punctuation\">,</span>midpointIndex<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n              <span class=\"token function\">mergeSort</span><span class=\"token punctuation\">(</span>array<span class=\"token punctuation\">,</span> midpointIndex<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> endIndex<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n              <span class=\"token function\">merge</span><span class=\"token punctuation\">(</span>array<span class=\"token punctuation\">,</span>startIndex<span class=\"token punctuation\">,</span>midpointIndex<span class=\"token punctuation\">,</span>endIndex<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n          <span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">}</span>\n\n      <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">merge</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> array<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span> startIndex<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span> midpointIndex<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span> endIndex<span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">{</span>\n          <span class=\"token keyword\">int</span> leftNumberOfElements <span class=\"token operator\">=</span> midpointIndex<span class=\"token operator\">-</span>startIndex<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n          <span class=\"token keyword\">int</span> rightNumberOfElements <span class=\"token operator\">=</span> endIndex<span class=\"token operator\">-</span>midpointIndex<span class=\"token punctuation\">;</span>\n\n          <span class=\"token keyword\">int</span> leftArray<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token keyword\">int</span><span class=\"token punctuation\">[</span>leftNumberOfElements<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n          <span class=\"token keyword\">int</span> rightArray<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token keyword\">int</span><span class=\"token punctuation\">[</span>rightNumberOfElements<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n          <span class=\"token keyword\">int</span> i<span class=\"token punctuation\">,</span>j<span class=\"token punctuation\">,</span>k<span class=\"token punctuation\">;</span>\n\n          <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span>i<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">&lt;</span> leftNumberOfElements<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">{</span>\n              leftArray<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> array<span class=\"token punctuation\">[</span>startIndex<span class=\"token operator\">+</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n          <span class=\"token punctuation\">}</span>\n          <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span>j<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span> j<span class=\"token operator\">&lt;</span> rightNumberOfElements<span class=\"token punctuation\">;</span> j<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">{</span>\n              rightArray<span class=\"token punctuation\">[</span>j<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> array<span class=\"token punctuation\">[</span>midpointIndex<span class=\"token operator\">+</span>j<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n          <span class=\"token punctuation\">}</span>\n\n          leftArray<span class=\"token punctuation\">[</span>leftNumberOfElements<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token class-name\">Integer</span><span class=\"token punctuation\">.</span>MAX_VALUE<span class=\"token punctuation\">;</span>\n          rightArray<span class=\"token punctuation\">[</span>rightNumberOfElements<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token class-name\">Integer</span><span class=\"token punctuation\">.</span>MAX_VALUE<span class=\"token punctuation\">;</span>\n\n          i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n          j <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n          <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span>k <span class=\"token operator\">=</span> startIndex<span class=\"token punctuation\">;</span> k<span class=\"token operator\">&lt;=</span> endIndex<span class=\"token punctuation\">;</span> k<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">{</span>\n\n              <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span> leftArray<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token operator\">&lt;=</span>rightArray<span class=\"token punctuation\">[</span>j<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n              <span class=\"token punctuation\">{</span>\n                  array<span class=\"token punctuation\">[</span>k<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> leftArray<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n                  i <span class=\"token operator\">=</span> i<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n              <span class=\"token punctuation\">}</span>\n              <span class=\"token keyword\">else</span>\n              <span class=\"token punctuation\">{</span>\n                  array<span class=\"token punctuation\">[</span>k<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> rightArray<span class=\"token punctuation\">[</span>j<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n                  j <span class=\"token operator\">=</span> j<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n\n              <span class=\"token punctuation\">}</span>\n          <span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">}</span>\n\n      <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">printArray</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> array<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n          <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> array<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n              <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">print</span><span class=\"token punctuation\">(</span>array<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token string\">\" \"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n          <span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span></code></pre></div>","frontmatter":{"author":["Thomas H. Cornmen","And","Charles E Leiserson","And","Ronald L. Riverest","And","Clifford Stein"],"seo_description":"Introduction to Algorithms by Thomas H. Cornmen and Charles E Leiserson and Ronald L. Riverest and Clifford Stein notes.","title":"Merge Sort"}}},"pageContext":{"slug":"/books/introduction-to-algorithms/merge-sort/"}},"staticQueryHashes":["1584199405","4008572679"]}